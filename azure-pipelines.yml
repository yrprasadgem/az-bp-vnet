# TF
# TF plan and push and apply 


trigger:
- master

resources:
- repo: self

pool:
  devops-terraform-agent
  
steps:
  
- task: CmdLine@2
  displayName: Terraform Version
  inputs:
    script: 'terraform version' 

- task: CmdLine@2
  displayName: Terraform Init Delete
  inputs:
    script: 'rm -rf .terraform || true'

- task: CmdLine@2
  displayName: Terraform Init
  inputs:
    script: 'source /home/contouradmin/terraform/tftest_psql_montr/init-terraform-tftset_bkp && terraform init'

- task: CmdLine@2
  displayName: Terraform Plan
  inputs:
    script: 'source /home/contouradmin/terraform/tftest_psql_montr/init-terraform-tftset_bkp && terraform plan -out=tfplan'

- task: CmdLine@2
  displayName: Terraform Apply
  inputs:
    script: 'source /home/contouradmin/terraform/tftest_psql_montr/init-terraform-tftset_bkp && terraform destroy --auto-approve'
